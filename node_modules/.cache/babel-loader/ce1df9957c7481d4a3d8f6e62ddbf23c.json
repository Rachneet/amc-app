{"ast":null,"code":"import _regeneratorRuntime from\"/home/rachneet/PycharmProjects/amc_react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/rachneet/PycharmProjects/amc_react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/rachneet/PycharmProjects/amc_react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState}from'react';import Message from'./Message';import Progress from'./Progress';import axios from'axios';var FileUpload=function FileUpload(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useState3=useState('Choose File'),_useState4=_slicedToArray(_useState3,2),filename=_useState4[0],setFilename=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),uploadedFile=_useState6[0],setUploadedFile=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),uploadPercentage=_useState10[0],setUploadPercentage=_useState10[1];var onChange=function onChange(e){setFile(e.target.files[0]);setFilename(e.target.files[0].name);};var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var formData,res,_res$data,fileName,filePath;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();formData=new FormData();formData.append('file',file);_context.prev=3;_context.next=6;return axios.post('http://127.0.0.1:5000/api/upload',formData,{headers:{'Content-Type':'multipart/form-data'},onUploadProgress:function onUploadProgress(progressEvent){setUploadPercentage(parseInt(Math.round(progressEvent.loaded*100/progressEvent.total)));// Clear percentage\nsetTimeout(function(){return setUploadPercentage(0);},10000);}});case 6:res=_context.sent;_res$data=res.data,fileName=_res$data.fileName,filePath=_res$data.filePath;setUploadedFile({fileName:fileName,filePath:filePath});setMessage('File Uploaded');_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](3);if(_context.t0.response.status===500){setMessage('There was a problem with the server');}else{setMessage(_context.t0.response.data.msg);}case 15:case\"end\":return _context.stop();}}},_callee,null,[[3,12]]);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(Fragment,null,message?/*#__PURE__*/React.createElement(Message,{msg:message}):null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:onSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"custom-file mb-4\"},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",className:\"custom-file-input\",id:\"customFile\",onChange:onChange}),/*#__PURE__*/React.createElement(\"label\",{className:\"custom-file-label\",htmlFor:\"customFile\"},filename)),/*#__PURE__*/React.createElement(Progress,{percentage:uploadPercentage}),/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Upload\",className:\"btn btn-primary btn-block mt-4\"})),uploadedFile?/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6 m-auto\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"text-center\"},uploadedFile.fileName),/*#__PURE__*/React.createElement(\"img\",{style:{width:'100%'},src:uploadedFile.filePath,alt:\"\"}))):null);};export default FileUpload;","map":{"version":3,"sources":["/home/rachneet/PycharmProjects/amc_react/src/FileUpload.js"],"names":["React","Fragment","useState","Message","Progress","axios","FileUpload","file","setFile","filename","setFilename","uploadedFile","setUploadedFile","message","setMessage","uploadPercentage","setUploadPercentage","onChange","e","target","files","name","onSubmit","preventDefault","formData","FormData","append","post","headers","onUploadProgress","progressEvent","parseInt","Math","round","loaded","total","setTimeout","res","data","fileName","filePath","response","status","msg","width"],"mappings":"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","sourcesContent":["import React, { Fragment, useState } from 'react';\r\nimport Message from './Message';\r\nimport Progress from './Progress';\r\nimport axios from 'axios';\r\n\r\nconst FileUpload = () => {\r\n  const [file, setFile] = useState('');\r\n  const [filename, setFilename] = useState('Choose File');\r\n  const [uploadedFile, setUploadedFile] = useState({});\r\n  const [message, setMessage] = useState('');\r\n  const [uploadPercentage, setUploadPercentage] = useState(0);\r\n\r\n  const onChange = e => {\r\n    setFile(e.target.files[0]);\r\n    setFilename(e.target.files[0].name);\r\n  };\r\n\r\n  const onSubmit = async e => {\r\n    e.preventDefault();\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n\r\n    try {\r\n      const res = await axios.post('http://127.0.0.1:5000/api/upload', formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data'\r\n        },\r\n        onUploadProgress: progressEvent => {\r\n          setUploadPercentage(\r\n            parseInt(\r\n              Math.round((progressEvent.loaded * 100) / progressEvent.total)\r\n            )\r\n          );\r\n\r\n          // Clear percentage\r\n          setTimeout(() => setUploadPercentage(0), 10000);\r\n        }\r\n      });\r\n\r\n      const { fileName, filePath } = res.data;\r\n\r\n      setUploadedFile({ fileName, filePath });\r\n\r\n      setMessage('File Uploaded');\r\n    } catch (err) {\r\n      if (err.response.status === 500) {\r\n        setMessage('There was a problem with the server');\r\n      } else {\r\n        setMessage(err.response.data.msg);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      {message ? <Message msg={message} /> : null}\r\n      <form onSubmit={onSubmit}>\r\n        <div className='custom-file mb-4'>\r\n          <input\r\n            type='file'\r\n            className='custom-file-input'\r\n            id='customFile'\r\n            onChange={onChange}\r\n          />\r\n          <label className='custom-file-label' htmlFor='customFile'>\r\n            {filename}\r\n          </label>\r\n        </div>\r\n\r\n        <Progress percentage={uploadPercentage} />\r\n\r\n        <input\r\n          type='submit'\r\n          value='Upload'\r\n          className='btn btn-primary btn-block mt-4'\r\n        />\r\n      </form>\r\n      {uploadedFile ? (\r\n        <div className='row mt-5'>\r\n          <div className='col-md-6 m-auto'>\r\n            <h3 className='text-center'>{uploadedFile.fileName}</h3>\r\n            <img style={{ width: '100%' }} src={uploadedFile.filePath} alt='' />\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default FileUpload;"]},"metadata":{},"sourceType":"module"}